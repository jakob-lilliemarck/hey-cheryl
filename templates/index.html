<!doctype html>
<html>
    <head>
        <title>Cheryl</title>
        <script src="https://unpkg.com/socket.io-client@4.8.1/dist/socket.io.min.js"></script>
        <style>
            html {
                font-family: "Courier New", Courier, monospace;
                background: #f2f2f2;
                display: flex;
                align-items: center;
                justify-content: center;
                height: 100%;
                width: 100%;
            }
            body {
                display: flex;
                flex-direction: column;
                align-items: center;
                max-width: 700px;
                height: 100%;
                width: 100%;
                flex-grow: 1;
                gap: 1rem;
            }
            #messages {
                display: flex;
                flex-direction: column;
                width: 100%;
                height: 100%;
                flex-grow: 1;
                gap: 1rem;
                background: #fff;
                overflow-y: scroll;
                margin-top: 1rem;
                padding: 1rem;
                border-radius: 0.25rem;
            }
            #messageInput {
                width: 100%;
                background: #fff;
                width: 100%;
                outline: none;
                border: none;
                padding: 1rem;
                margin-bottom: 1rem;
                border-radius: 0.25rem;
            }
        </style>
    </head>
    <body>
        <div id="messages"></div>
        <input type="text" id="messageInput" placeholder="Ask Cheryl" />
        <script>
            var socket = io(); // Connect to the Socket.IO server
            var messages = document.getElementById("messages");
            var messageInput = document.getElementById("messageInput");

            socket.on("connect", function () {
                messages.innerHTML += "<p>Connected to server!</p>";
            });

            socket.on("disconnect", function () {
                messages.innerHTML += "<p>Disconnected from server!</p>";
            });

            socket.on("my response", function (data) {
                messages.innerHTML += "<p>Server: " + data.data + "</p>";
                messages.scrollTop = messages.scrollHeight; // Scroll to the bottom
            });

            function sendMessage() {
                var message = messageInput.value;
                socket.emit("my event", { data: message }); // Send a message to the server
                messages.innerHTML += "<p>You: " + message + "</p>";
                messageInput.value = ""; // Clear the input field
                messages.scrollTop = messages.scrollHeight; // Scroll to the bottom
            }

            messageInput.addEventListener("keypress", function (event) {
                if (event.key === "Enter") {
                    event.preventDefault();
                    sendMessage();
                }
            });

            const CONVERSATION_ID_KEY = "conversationID";
            function getConversationID() {
                let conversationID = localStorage.getItem(CONVERSATION_ID_KEY);
                if (conversationID == null) {
                    conversationID = crypto.randomUUID();
                    localStorage.setItem(CONVERSATION_ID_KEY, conversationID);
                }
                return conversationID;
            }
        </script>
    </body>
</html>
